---
date: 2025-08-20
readtime: 7 
title: Custom ESP32 Symbol and Component Selection
description: v1.0 Finalized
---

## Planned Tasks

- [x] Create the component and footprint for the ESP32 FREENOVE dev board
- [x] Look into alternative TVR diodes


## TVR Research and ESP32 Footprint

Overall, with additional components like ferrite beads and more capacitor banks, the effects of any voltage spikes up to the clamping voltage of ~9V for the TVR shouldn't propagate too far past into the regulator. So with these extra protections, I will be keeping the TVR that I found previously.

Once this had been completed, I started to make a symbol and footprint for the ESP32 dev board that I had, which turned out to be pretty obscure as there was little to no documentation. However, using the pinout and provided module datasheets, I was able to make the symbol and footprint in a couple hours.

![ESP32 Board Pinout[caption]](../assets/Freenove_ESP32_WROOM_Board_Pinout.png "ESP32 Board Pinout")
![Custom ESP32 Symbol in KiCad[caption]](../assets/ESP32_Custom_Symbol.png "Custom ESP32 Symbol in KiCad")
![Custom ESP32 Footprint in KiCad[caption]](../assets/ESP32_Custom_Footprint.png "Custom ESP32 Footprint in KiCad")



## Other Footprints and Component Selection

Finishing up the ESP32 symbol and footprint, I proceeded to create a sheet for the flight controller and attach the corresponding nets to the pins. 

![ESP32 Connection Schematic - v1.0[caption]](../assets/v1.0_ESP32_Connection_Schematic.png "ESP32 Connection Schematic - v1.0")

Now, it was time to start selecting components and finding the correct footprints for each part. During this whole process, I created and started filling out a [[V1.0 BOM]] as well to keep track of all the needed parts.

Starting with the ferrite bead, I chose one that could handle the current into and out of the regulator while being large enough to hand solder. This eventually lead to me choosing the [MPZ1608S101ATAH0](https://www.digikey.ca/en/products/detail/tdk-corporation/MPZ1608S101ATAH0/571871) with its 0603 size and 2A rating. These ferrite beads additionally help to isolate the regulator and ESP line from both voltage spikes and any noise from the motor line.

The MOSFET already had a preselected footprint for SOT-23, which I changed to the hand soldering version for extended pads.

For the ceramic capacitors, I choose ones that the regulator datasheet recommended, 10 Î¼F 6.3 V, 0603, X7R. However, after researching more online, I eventually went to search for capacitors that had a rating of 10V instead as the DC bias could reduce the capacitance of the capacitors, reducing the energy it can store. This lead me to choose the following capacitors for my circuit:
- 0.1uF: [GCJ188R71C104MA01J](https://www.digikey.ca/en/products/detail/murata-electronics/gcj188r71c104ma01j/10697171)
- 10uF: [GRM188Z71A106MA73J](https://www.digikey.ca/en/products/detail/murata-electronics/GRM188Z71A106MA73J/17854471?s=N4IgTCBcDaIOICUCyBGAHGgWgdhQQRQAYA2JPbAZgCkQBdAXyA)

With both capacitors having the 0603 size, it was easy to find the footprint as I just chose the standard 0603 hand solder footprint for capacitors.

For the resistors, since they act as gate and gate to source resistors, the current through them and thus power dissipated won't be too large. Thus, I chose resistors that were around the 1/5 to 1/10W range. Since the resistance itself didn't matter much, cheaper 5% tolerance resistors were fine. This lead to me choosing the following resistors:
- 22Ohm: [RC0603JR-0722RL](https://www.digikey.ca/en/products/detail/yageo/RC0603JR-0722RL/726743)
- 100Ohm: [RC0603JR-13100RL](https://www.digikey.ca/en/products/detail/yageo/RC0603JR-13100RL/13694093)
- 100kOhm: [CR0603-JW-104ELF](https://www.digikey.ca/en/products/detail/bourns-inc/CR0603-JW-104ELF/2345098)

These resistors all had the 0603 size as well, and similar to the capacitors, I chose the hand soldering 0603 footprint for resistors. 

As for the large 1000uF electrolytic capacitor that acts as an energy bank, I chose a cheap one that had a rated voltage higher than my system's voltage. Eventually, I choose the [UCD0J102MNL1GS](https://www.digikey.ca/en/products/detail/nichicon/ucd0j102mnl1gs/2549609). For the footprint, I had to download and import the model that was given on DigiKey

For the [SS34](https://www.digikey.ca/en/products/detail/shenzhen-slkormicro-semicon-co-ltd/ss34/21853055) Schottky diode and [SMAJ5.0A](https://www.digikey.ca/en/products/detail/good-ark-semiconductor/smaj5-0a/18649116) TVR diode, the footprints were already present within KiCad which made it easier to find. 

For the inductor, I found the cheapest one that matched the recommended one from the regulator datasheet, which was the [VLS3012HBX-2R2M](https://www.digikey.ca/en/products/detail/tdk-corporation/VLS3012HBX-2R2M/7387441). I also downloaded the footprint for this from DigiKey.

For the motors, I already had PB1.25mm 2Pos connectors that I could use, which could fit the Molex PicoBlade connectors. I then chose a connector header that was through hole, since the handling of unplugging the motor may rip off a SMD header. This was the [0530480210](https://www.digikey.ca/en/products/detail/molex/0530480210/242864), which I also got the footprint from DigiKey.

Right here, I began to also look into battery connectors for the drone batteries that I could buy off Amazon. However, I noticed that all of them used an outdated 51005 Molex connector, which was now out of production. This made it really hard to find the right connector, so eventually, I moved onto finding lithium batteries that had a newer standardized JBT connector. This will probably be a task for next time as I will have to find a battery, the corresponding header, and a charger.

Once I had finished here, I imported all these footprints into the KiCad PCB editor to had a look and start designing the PCB. However, I instantly noticed a problem. The voltage regulator was way too small to be hand soldered, and also included a pad on the underside for ground. This meant that I either had to order the PCB pre-assembled or choose a different IC. Since I wanted practice on soldering small SMD parts, I chose the latter option. 


## Finding a new voltage regulator IC

To being looking for a replacement, I started the search on DigiKey, where I looked for all buck-boost regulators with a fixed output of 3.3V and at least 0.5A current. After half and hour of scrolling through, however, I saw that all of them were SMD and impossible to hand solder. The ones that could be hand soldered all had maximum current ratings of less than 0.4A, which couldn't run my ESP32. 

Then, I remember about some linear voltage regulators that I've used before in my PHAS ELAB course, which converted an input VIN to a fixed VOUT. I tried to look at some random ones to see if a lower VIN than the fixed VOUT is possible for these ICs, and it was. However, these regulators had drop out voltages, and if VIN was lower than VOUT, then VOUT would be the VIN minus the dropout. This was something else that I had to check now. Since a 3.7V battery can reach down to 3.0V when it is almost empty, my worst case for ESP32 input voltage would be this 3.0V minus the dropout voltage.

Looking back through the various ESP32 datasheets, I found that the ESP32 32E module that was present on my dev board could actually take lower voltages. The recommended operating conditions were between 2.2-3.6V, as long as this was put into the VD33 pin, which was present on my dev board (pin 1). This meant that I could actually use a linear voltage regulator, as long as I found one with low dropout (VDO).

Eventually, after filtering by output voltage (3.3V), maximum dropout (~0.2-0.4V), minimum current (0.5A), and package type/size, I was able to find a suitable LDO. This was the [AP2112R5-3.3TRG1](https://www.digikey.ca/en/products/detail/diodes-incorporated/AP2112R5-3-3TRG1/5305557), which was 3.3V 600mA with a 0.4V dropout at 600mA. However, this also introduced a slight problem of overheating, as this LDO would dissipate heat with increasing dropout voltage.

This meant that I would need to consider a ground plane for heat dissipation. The part that I chose specifically had a larger package of SOT-89, which helps for conducting that heat. This copper ground plate would be specifically for the ESP32 line. Using ChatGPT to research the specifics and advise on the process of finding the temperature, I found the following:

![ChatGPT's Response on Heat Dissipation (1)[caption]](../assets/v1.0_ChatGPT_Power_1.png "ChatGPT's Response on Heat Dissipation (1)")
![ChatGPT's Response on Heat Dissipation (2)[caption]](../assets/v1.0_ChatGPT_Power_2.png "ChatGPT's Response on Heat Dissipation (2)")

This meant that, even at the worse case where my copper ground pour was ineffective, the junction temperature would be around 79\*C, which is well bellow the IC's max temperature of 150\*C, but will still mean that the IC may get warm. 

Confirming all of this, I have decided to switch over to this new LDO, which makes it easier to solder but introduces larger dropout voltage and heating. I will being looking further into implementing this IC into my circuit next day.

The current schematic and footprints, will be the **version 1.0**. The version has been frozen and saved into version control, and screenshots are saved into the [PCB v1.0 section](#PCB-v1_0). To change the LDO and implementing new battery connectors, I will move onto version 1.1.
